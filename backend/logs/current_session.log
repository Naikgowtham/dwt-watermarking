[2025-07-12 10:25:20,823] [INFO] [__main__] Launching Flask server...
[2025-07-12 10:25:20,823] [INFO] [__main__] Creating Flask app...
[2025-07-12 10:25:20,823] [INFO] [__main__] Registering watermark blueprint...
[2025-07-12 10:25:20,830] [ERROR] [__main__]  * Debugger is active!
[2025-07-12 10:25:20,830] [ERROR] [__main__]  * Debugger PIN: 939-065-228
[2025-07-12 10:25:35,303] [DEBUG] [__main__] Received a new request.
[2025-07-12 10:25:35,304] [INFO] [routes.watermark_routes] POST /watermark called
[2025-07-12 10:25:35,306] [DEBUG] [routes.watermark_routes] Received file: filename=Screenshot from 2025-07-08 13-42-10.png, content_type=image/png
[2025-07-12 10:25:35,306] [DEBUG] [routes.watermark_routes] Received message of length 4 characters
[2025-07-12 10:25:35,306] [DEBUG] [routes.watermark_routes] Loading original image from uploaded file
[2025-07-12 10:25:35,306] [DEBUG] [utils.image_utils] Attempting to load image from uploaded file...
[2025-07-12 10:25:35,339] [DEBUG] [utils.image_utils] Image successfully loaded. Shape: (1080, 1920, 3)
[2025-07-12 10:25:35,339] [INFO] [routes.watermark_routes] Original image loaded: shape=(1080, 1920, 3), dtype=uint8
[2025-07-12 10:25:35,339] [DEBUG] [routes.watermark_routes] Attempting to extract existing hash and messages for appending support
[2025-07-12 10:25:35,564] [DEBUG] [core.dwt_engine] Extracted first 32 bits: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[2025-07-12 10:25:35,565] [DEBUG] [core.dwt_engine] Total bits extracted: 2073600
[2025-07-12 10:25:35,566] [DEBUG] [routes.watermark_routes] Extracted 2073600 bits from image for parent hash extraction.
[2025-07-12 10:25:35,566] [ERROR] [__main__] Invalid or out-of-bounds message length at cursor 256: 65535. Stopping parse.
[2025-07-12 10:25:35,566] [DEBUG] [routes.watermark_routes] Detected format: hash_based, found 0 existing messages.
[2025-07-12 10:25:35,566] [INFO] [routes.watermark_routes] Extracted parent hash from image: ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
[2025-07-12 10:25:35,571] [INFO] [routes.watermark_routes] SHA256 of uploaded image: [1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 1, 0]
[2025-07-12 10:25:35,571] [WARNING] [routes.watermark_routes] File-level chain broken: parent hash (ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff) does not match uploaded image hash ([1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 1, 0]).
[2025-07-12 10:25:36,632] [ERROR] [__main__] Error fetching watermark from chain: ('execution reverted: Watermark not found', '0x08c379a00000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000001357617465726d61726b206e6f7420666f756e6400000000000000000000000000')
Traceback (most recent call last):
  File "/home/gowtham/dwt-watermarking/backend/utils/blockchain_utils.py", line 102, in get_watermark_from_chain
    entry = contract.functions.getWatermark(parent_hash_bytes).call()
  File "/home/gowtham/dwt-watermarking/backend/venv/lib/python3.10/site-packages/web3/contract/contract.py", line 291, in call
    return call_contract_function(
  File "/home/gowtham/dwt-watermarking/backend/venv/lib/python3.10/site-packages/web3/contract/utils.py", line 153, in call_contract_function
    return_data = w3.eth.call(
  File "/home/gowtham/dwt-watermarking/backend/venv/lib/python3.10/site-packages/web3/eth/eth.py", line 247, in call
    return self._durin_call(transaction, block_identifier, state_override)
  File "/home/gowtham/dwt-watermarking/backend/venv/lib/python3.10/site-packages/web3/eth/eth.py", line 266, in _durin_call
    return self._call(transaction, block_identifier, state_override)
  File "/home/gowtham/dwt-watermarking/backend/venv/lib/python3.10/site-packages/web3/module.py", line 112, in caller
    result = w3.manager.request_blocking(
  File "/home/gowtham/dwt-watermarking/backend/venv/lib/python3.10/site-packages/web3/manager.py", line 232, in request_blocking
    return self.formatted_response(
  File "/home/gowtham/dwt-watermarking/backend/venv/lib/python3.10/site-packages/web3/manager.py", line 198, in formatted_response
    validate_rpc_response_and_raise_if_error(
  File "/home/gowtham/dwt-watermarking/backend/venv/lib/python3.10/site-packages/web3/_utils/validation.py", line 397, in validate_rpc_response_and_raise_if_error
    response = apply_error_formatters(error_formatters, response)
  File "/home/gowtham/dwt-watermarking/backend/venv/lib/python3.10/site-packages/web3/_utils/formatters.py", line 146, in apply_error_formatters
    formatted_resp = pipe(response, error_formatters)
  File "cytoolz/functoolz.pyx", line 685, in cytoolz.functoolz.pipe
  File "cytoolz/functoolz.pyx", line 660, in cytoolz.functoolz.c_pipe
  File "/home/gowtham/dwt-watermarking/backend/venv/lib/python3.10/site-packages/web3/_utils/error_formatters_utils.py", line 166, in raise_contract_logic_error_on_revert
    raise ContractLogicError(message, data=data)
web3.exceptions.ContractLogicError: ('execution reverted: Watermark not found', '0x08c379a00000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000001357617465726d61726b206e6f7420666f756e6400000000000000000000000000')
[2025-07-12 10:25:36,632] [WARNING] [routes.watermark_routes] Blockchain chain broken: no watermark record found for parent hash ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff.
[2025-07-12 10:25:36,633] [INFO] [routes.watermark_routes] Total messages to embed: 1
[2025-07-12 10:25:36,633] [DEBUG] [routes.watermark_routes] Preparing bitstream with SHA256 hash and multi-message framing
[2025-07-12 10:25:36,636] [INFO] [routes.watermark_routes] Combined bitstream length: 304 bits
[2025-07-12 10:25:36,637] [DEBUG] [routes.watermark_routes] Embedding combined bitstream into image via DWT parity
[2025-07-12 10:25:36,714] [DEBUG] [core.dwt_engine] Embedding 304 bits in Y channel parity
[2025-07-12 10:25:36,715] [DEBUG] [core.dwt_engine] Y-parity embed check: 304 bits embedded, 0 mismatches
[2025-07-12 10:25:36,716] [INFO] [routes.watermark_routes] Embedding complete without mismatches
[2025-07-12 10:25:36,717] [DEBUG] [routes.watermark_routes] Saving original image to /home/gowtham/dwt-watermarking/backend/uploads/original/db7bb952d41a4772a4caf7adc35cf194_orig.png
[2025-07-12 10:25:36,717] [DEBUG] [utils.image_utils] Attempting to save image to path: /home/gowtham/dwt-watermarking/backend/uploads/original/db7bb952d41a4772a4caf7adc35cf194_orig.png
[2025-07-12 10:25:36,739] [DEBUG] [utils.image_utils] Image saved successfully.
[2025-07-12 10:25:36,739] [INFO] [routes.watermark_routes] Original image saved successfully
[2025-07-12 10:25:36,739] [DEBUG] [routes.watermark_routes] Saving watermarked image to /home/gowtham/dwt-watermarking/backend/uploads/watermarked/db7bb952d41a4772a4caf7adc35cf194_wm.png
[2025-07-12 10:25:36,739] [DEBUG] [utils.image_utils] Attempting to save image to path: /home/gowtham/dwt-watermarking/backend/uploads/watermarked/db7bb952d41a4772a4caf7adc35cf194_wm.png
[2025-07-12 10:25:36,761] [DEBUG] [utils.image_utils] Image saved successfully.
[2025-07-12 10:25:36,761] [INFO] [routes.watermark_routes] Watermarked image saved successfully
[2025-07-12 10:25:36,761] [INFO] [routes.watermark_routes] Starting upload of original and watermarked images to Pinata Cloud (IPFS)...
[2025-07-12 10:25:36,761] [INFO] [utils.ipfs_utils] Uploading /home/gowtham/dwt-watermarking/backend/uploads/original/db7bb952d41a4772a4caf7adc35cf194_orig.png to Pinata Cloud...
[2025-07-12 10:25:39,526] [INFO] [utils.ipfs_utils] File uploaded successfully to Pinata. CID: QmUyrPkd4pEJTednpk6ubu731Lw43MZjggURP54pzG5iVE
[2025-07-12 10:25:39,527] [INFO] [routes.watermark_routes] Original image uploaded to Pinata. CID: QmUyrPkd4pEJTednpk6ubu731Lw43MZjggURP54pzG5iVE
[2025-07-12 10:25:39,527] [INFO] [utils.ipfs_utils] Uploading /home/gowtham/dwt-watermarking/backend/uploads/watermarked/db7bb952d41a4772a4caf7adc35cf194_wm.png to Pinata Cloud...
[2025-07-12 10:25:41,850] [INFO] [utils.ipfs_utils] File uploaded successfully to Pinata. CID: QmYcZTjHoNjjL3oVRRdAH3WdH9DK9EUfCGJ6rdvK4HaFka
[2025-07-12 10:25:41,850] [INFO] [routes.watermark_routes] Watermarked image uploaded to Pinata. CID: QmYcZTjHoNjjL3oVRRdAH3WdH9DK9EUfCGJ6rdvK4HaFka
[2025-07-12 10:25:41,850] [INFO] [routes.watermark_routes] IPFS upload step completed in 5.09 seconds.
[2025-07-12 10:25:41,861] [INFO] [routes.watermark_routes] Original image SHA256 hash: 85376ac43ee90d8929c60a2c011ac4a8253596f6e01f12c122dd9966f80863a2
[2025-07-12 10:25:41,861] [INFO] [routes.watermark_routes] Watermarked image SHA256 hash: 9e980dbe0f83e4fd530677a0cf00a975d93e4c82e19b73d33c02fa2bc3133609
[2025-07-12 10:25:41,861] [INFO] [routes.watermark_routes] Combined message string: wwww
[2025-07-12 10:25:41,861] [INFO] [routes.watermark_routes] CRC value: 12866
[2025-07-12 10:25:41,861] [INFO] [routes.watermark_routes] Using extracted parent hash: ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
[2025-07-12 10:25:44,280] [INFO] [__main__] Transaction sent. Hash: 0x93df02a005719e872f30beae2a5435a36e05f9b0de0fbb097682f42ddd51672c
[2025-07-12 10:25:45,649] [INFO] [__main__] Transaction mined in block 23808221 with status 1
[2025-07-12 10:25:45,649] [INFO] [routes.watermark_routes] Logged watermark to blockchain. Tx hash: 0x93df02a005719e872f30beae2a5435a36e05f9b0de0fbb097682f42ddd51672c
[2025-07-12 10:25:45,650] [DEBUG] [routes.watermark_routes] Encoding watermarked image at /home/gowtham/dwt-watermarking/backend/uploads/watermarked/db7bb952d41a4772a4caf7adc35cf194_wm.png to base64
[2025-07-12 10:25:45,650] [DEBUG] [utils.image_utils] Attempting to convert image to base64 from path: /home/gowtham/dwt-watermarking/backend/uploads/watermarked/db7bb952d41a4772a4caf7adc35cf194_wm.png
[2025-07-12 10:25:45,650] [DEBUG] [utils.image_utils] Image successfully encoded to base64.
[2025-07-12 10:25:45,651] [INFO] [routes.watermark_routes] Base64 encoding complete
[2025-07-12 10:25:45,651] [INFO] [routes.watermark_routes] POST /watermark completed successfully
[2025-07-12 10:25:45,660] [INFO] [__main__] App context teardown complete.
[2025-07-12 10:25:45,661] [ERROR] [__main__] 127.0.0.1 - - [12/Jul/2025 10:25:45] "POST /watermark HTTP/1.1" 200 -
[2025-07-12 10:26:28,259] [DEBUG] [__main__] Received a new request.
[2025-07-12 10:26:28,259] [INFO] [routes.watermark_routes] POST /extract called
[2025-07-12 10:26:28,262] [DEBUG] [routes.watermark_routes] Loading watermarked image: filename=db7bb952d41a4772a4caf7adc35cf194_wm.png
[2025-07-12 10:26:28,262] [DEBUG] [utils.image_utils] Attempting to load image from uploaded file...
[2025-07-12 10:26:28,288] [DEBUG] [utils.image_utils] Image successfully loaded. Shape: (1080, 1920, 3)
[2025-07-12 10:26:28,288] [INFO] [routes.watermark_routes] Watermarked image loaded: shape=(1080, 1920, 3), dtype=uint8
[2025-07-12 10:26:28,288] [DEBUG] [routes.watermark_routes] Extracting full parity bitstream via DWT engine
[2025-07-12 10:26:28,505] [DEBUG] [core.dwt_engine] Extracted first 32 bits: [1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0]
[2025-07-12 10:26:28,505] [DEBUG] [core.dwt_engine] Total bits extracted: 2073600
[2025-07-12 10:26:28,506] [INFO] [routes.watermark_routes] Extracted total bitstream length: 2073600 bits
[2025-07-12 10:26:28,506] [DEBUG] [routes.watermark_routes] First 32 bits of bitstream: [1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0]
[2025-07-12 10:26:28,506] [ERROR] [__main__] Invalid or out-of-bounds message length at cursor 304: 65535. Stopping parse.
[2025-07-12 10:26:28,506] [INFO] [routes.watermark_routes] Detected format: hash_based, extracted 1 messages
[2025-07-12 10:26:28,506] [INFO] [routes.watermark_routes] Extracted SHA256 hash: 85376ac43ee90d8929c60a2c011ac4a8253596f6e01f12c122dd9966f80863a2
[2025-07-12 10:26:29,691] [INFO] [routes.watermark_routes] Blockchain metadata found for hash 85376ac43ee90d8929c60a2c011ac4a8253596f6e01f12c122dd9966f80863a2. CRC match: True
[2025-07-12 10:26:29,691] [INFO] [routes.watermark_routes] Extraction complete: 1 messages found
[2025-07-12 10:26:29,698] [INFO] [__main__] App context teardown complete.
[2025-07-12 10:26:29,698] [ERROR] [__main__] 127.0.0.1 - - [12/Jul/2025 10:26:29] "POST /extract HTTP/1.1" 200 -
[2025-07-12 10:26:59,413] [DEBUG] [__main__] Received a new request.
[2025-07-12 10:26:59,413] [INFO] [routes.watermark_routes] POST /watermark called
[2025-07-12 10:26:59,415] [DEBUG] [routes.watermark_routes] Received file: filename=db7bb952d41a4772a4caf7adc35cf194_wm.png, content_type=image/png
[2025-07-12 10:26:59,415] [DEBUG] [routes.watermark_routes] Received message of length 3 characters
[2025-07-12 10:26:59,415] [DEBUG] [routes.watermark_routes] Loading original image from uploaded file
[2025-07-12 10:26:59,416] [DEBUG] [utils.image_utils] Attempting to load image from uploaded file...
[2025-07-12 10:26:59,445] [DEBUG] [utils.image_utils] Image successfully loaded. Shape: (1080, 1920, 3)
[2025-07-12 10:26:59,445] [INFO] [routes.watermark_routes] Original image loaded: shape=(1080, 1920, 3), dtype=uint8
[2025-07-12 10:26:59,445] [DEBUG] [routes.watermark_routes] Attempting to extract existing hash and messages for appending support
[2025-07-12 10:26:59,668] [DEBUG] [core.dwt_engine] Extracted first 32 bits: [1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0]
[2025-07-12 10:26:59,668] [DEBUG] [core.dwt_engine] Total bits extracted: 2073600
[2025-07-12 10:26:59,668] [DEBUG] [routes.watermark_routes] Extracted 2073600 bits from image for parent hash extraction.
[2025-07-12 10:26:59,668] [ERROR] [__main__] Invalid or out-of-bounds message length at cursor 304: 65535. Stopping parse.
[2025-07-12 10:26:59,668] [DEBUG] [routes.watermark_routes] Detected format: hash_based, found 1 existing messages.
[2025-07-12 10:26:59,668] [INFO] [routes.watermark_routes] Extracted parent hash from image: 85376ac43ee90d8929c60a2c011ac4a8253596f6e01f12c122dd9966f80863a2
[2025-07-12 10:26:59,672] [INFO] [routes.watermark_routes] SHA256 of uploaded image: [1, 0, 0, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1]
[2025-07-12 10:26:59,672] [WARNING] [routes.watermark_routes] File-level chain broken: parent hash (85376ac43ee90d8929c60a2c011ac4a8253596f6e01f12c122dd9966f80863a2) does not match uploaded image hash ([1, 0, 0, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1]).
[2025-07-12 10:27:00,676] [INFO] [routes.watermark_routes] Blockchain chain intact: found watermark record for parent hash 85376ac43ee90d8929c60a2c011ac4a8253596f6e01f12c122dd9966f80863a2.
[2025-07-12 10:27:00,676] [INFO] [routes.watermark_routes] Total messages to embed: 2
[2025-07-12 10:27:00,676] [DEBUG] [routes.watermark_routes] Preparing bitstream with SHA256 hash and multi-message framing
[2025-07-12 10:27:00,681] [INFO] [routes.watermark_routes] Combined bitstream length: 344 bits
[2025-07-12 10:27:00,681] [DEBUG] [routes.watermark_routes] Embedding combined bitstream into image via DWT parity
[2025-07-12 10:27:00,743] [DEBUG] [core.dwt_engine] Embedding 344 bits in Y channel parity
[2025-07-12 10:27:00,743] [DEBUG] [core.dwt_engine] Y-parity embed check: 344 bits embedded, 0 mismatches
[2025-07-12 10:27:00,750] [INFO] [routes.watermark_routes] Embedding complete without mismatches
[2025-07-12 10:27:00,750] [DEBUG] [routes.watermark_routes] Saving original image to /home/gowtham/dwt-watermarking/backend/uploads/original/a65cf7ca34f64ac2b3f8780ed398db53_orig.png
[2025-07-12 10:27:00,750] [DEBUG] [utils.image_utils] Attempting to save image to path: /home/gowtham/dwt-watermarking/backend/uploads/original/a65cf7ca34f64ac2b3f8780ed398db53_orig.png
[2025-07-12 10:27:00,772] [DEBUG] [utils.image_utils] Image saved successfully.
[2025-07-12 10:27:00,772] [INFO] [routes.watermark_routes] Original image saved successfully
[2025-07-12 10:27:00,772] [DEBUG] [routes.watermark_routes] Saving watermarked image to /home/gowtham/dwt-watermarking/backend/uploads/watermarked/a65cf7ca34f64ac2b3f8780ed398db53_wm.png
[2025-07-12 10:27:00,772] [DEBUG] [utils.image_utils] Attempting to save image to path: /home/gowtham/dwt-watermarking/backend/uploads/watermarked/a65cf7ca34f64ac2b3f8780ed398db53_wm.png
[2025-07-12 10:27:00,793] [DEBUG] [utils.image_utils] Image saved successfully.
[2025-07-12 10:27:00,793] [INFO] [routes.watermark_routes] Watermarked image saved successfully
[2025-07-12 10:27:00,793] [INFO] [routes.watermark_routes] Starting upload of original and watermarked images to Pinata Cloud (IPFS)...
[2025-07-12 10:27:00,793] [INFO] [utils.ipfs_utils] Uploading /home/gowtham/dwt-watermarking/backend/uploads/original/a65cf7ca34f64ac2b3f8780ed398db53_orig.png to Pinata Cloud...
[2025-07-12 10:27:03,312] [INFO] [utils.ipfs_utils] File uploaded successfully to Pinata. CID: QmYcZTjHoNjjL3oVRRdAH3WdH9DK9EUfCGJ6rdvK4HaFka
[2025-07-12 10:27:03,312] [INFO] [routes.watermark_routes] Original image uploaded to Pinata. CID: QmYcZTjHoNjjL3oVRRdAH3WdH9DK9EUfCGJ6rdvK4HaFka
[2025-07-12 10:27:03,312] [INFO] [utils.ipfs_utils] Uploading /home/gowtham/dwt-watermarking/backend/uploads/watermarked/a65cf7ca34f64ac2b3f8780ed398db53_wm.png to Pinata Cloud...
[2025-07-12 10:27:05,572] [INFO] [utils.ipfs_utils] File uploaded successfully to Pinata. CID: QmQ1VokNG6diuqVHugE3KGZt6kd1qYzFbC5ov939Hy4zdM
[2025-07-12 10:27:05,572] [INFO] [routes.watermark_routes] Watermarked image uploaded to Pinata. CID: QmQ1VokNG6diuqVHugE3KGZt6kd1qYzFbC5ov939Hy4zdM
[2025-07-12 10:27:05,573] [INFO] [routes.watermark_routes] IPFS upload step completed in 4.78 seconds.
[2025-07-12 10:27:05,584] [INFO] [routes.watermark_routes] Original image SHA256 hash: 9e980dbe0f83e4fd530677a0cf00a975d93e4c82e19b73d33c02fa2bc3133609
[2025-07-12 10:27:05,584] [INFO] [routes.watermark_routes] Watermarked image SHA256 hash: 1dcd43a437592c2c83afce8bff9af73e8c7e48f69c412591c1eb50d8ab103e25
[2025-07-12 10:27:05,584] [INFO] [routes.watermark_routes] Combined message string: wwwwghf
[2025-07-12 10:27:05,584] [INFO] [routes.watermark_routes] CRC value: 20543
[2025-07-12 10:27:05,584] [INFO] [routes.watermark_routes] Using extracted parent hash: 85376ac43ee90d8929c60a2c011ac4a8253596f6e01f12c122dd9966f80863a2
[2025-07-12 10:27:07,751] [INFO] [__main__] Transaction sent. Hash: 0x2347d16b000e277f27d7426b22056a9ec2572caebb4940041897ecd2a3f70b59
[2025-07-12 10:27:09,577] [INFO] [__main__] Transaction mined in block 23808260 with status 1
[2025-07-12 10:27:09,577] [INFO] [routes.watermark_routes] Logged watermark to blockchain. Tx hash: 0x2347d16b000e277f27d7426b22056a9ec2572caebb4940041897ecd2a3f70b59
[2025-07-12 10:27:09,577] [DEBUG] [routes.watermark_routes] Encoding watermarked image at /home/gowtham/dwt-watermarking/backend/uploads/watermarked/a65cf7ca34f64ac2b3f8780ed398db53_wm.png to base64
[2025-07-12 10:27:09,577] [DEBUG] [utils.image_utils] Attempting to convert image to base64 from path: /home/gowtham/dwt-watermarking/backend/uploads/watermarked/a65cf7ca34f64ac2b3f8780ed398db53_wm.png
[2025-07-12 10:27:09,578] [DEBUG] [utils.image_utils] Image successfully encoded to base64.
[2025-07-12 10:27:09,578] [INFO] [routes.watermark_routes] Base64 encoding complete
[2025-07-12 10:27:09,578] [INFO] [routes.watermark_routes] POST /watermark completed successfully
[2025-07-12 10:27:09,586] [INFO] [__main__] App context teardown complete.
[2025-07-12 10:27:09,587] [ERROR] [__main__] 127.0.0.1 - - [12/Jul/2025 10:27:09] "POST /watermark HTTP/1.1" 200 -
